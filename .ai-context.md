# DirectStock AI Context

> Ultra-compact project context for any AI agent. For full governance, read `AGENTS.md`. For aerial view, read `llms.txt`.

## What Is This
A **Warehouse Management System (WMS)** for inventory, purchasing, shipping, and operations management.

## Current Phase
**Phase 5** — Full production feature set with 34 backend routers, 24 frontend pages, comprehensive agent governance.

## Tech Stack
- **Frontend**: React 19 + Vite 7 + Tailwind 4 + TypeScript + Zustand + TanStack Query
- **Backend**: FastAPI + SQLAlchemy 2.x + Alembic + PostgreSQL
- **Infra**: Docker Compose + Nginx reverse proxy + PWA
- **Agents**: Multi-provider (Anthropic/OpenAI/Google), 9 MCP servers, Ralph Loop CLI

## Key Paths
| Path | Purpose |
|---|---|
| `backend/app/routers/` | API endpoints |
| `backend/app/services/` | Business logic |
| `backend/app/schemas/` | API contracts (Pydantic) |
| `frontend/src/pages/` | UI page containers |
| `frontend/src/services/` | API client layer |
| `frontend/src/types.ts` | TypeScript types |
| `scripts/` | Automation & governance gates |
| `docs/agents/` | AI agent navigation docs |
| `llms.txt` | Universal LLM entry point |

## Architecture Pattern
```
Browser → Nginx → FastAPI routers → services → PostgreSQL
                   Frontend pages → services → /api/*
```

## Critical Invariants
1. **RBAC**: All mutations enforce role-based access control
2. **Audit**: All state changes produce audit log entries
3. **Idempotency**: All mutation endpoints are idempotent
4. **Services Layer**: No direct API calls from pages/routers — always via services
5. **File Size**: Pages <350 LOC, modules <500 LOC

## Active MCP Servers
| Server | Purpose |
|---|---|
| `directstock-filesystem` | File system access |
| `directstock-postgres` | Read-only database queries |
| `directstock-github` | GitHub integration |
| `directstock-playwright` | Browser automation |
| `directstock-git` | Git operations |
| `directstock-memory` | Persistent memory graph |
| `directstock-context7` | Library documentation |
| `directstock-fetch` | Web content fetching |

## Rules for AI Agents
1. Follow `AGENTS.md` (root) + nearest nested `AGENTS.md`
2. Mode: `unrestricted_senior` — full decision autonomy
3. Routers/pages orchestrate only; logic in services/hooks
4. File size: pages < 350 LOC, modules < 500 LOC
5. All mutations: RBAC + audit + idempotency
6. Frontend API calls go through `services/` layer only

## Provider Adapters
- Anthropic: `CLAUDE.md` + `docs/agents/providers/anthropic.md`
- OpenAI: `CODEX.md` + `docs/agents/providers/openai.md`
- Google: `GEMINI.md` + `docs/agents/providers/google.md`
