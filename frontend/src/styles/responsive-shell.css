@media (max-width: 1100px) {
  .shell.mobile-layout {
    grid-template-columns: minmax(0, 1fr);
  }

  .shell.mobile-layout .sidebar {
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    width: min(320px, 84vw);
    height: auto;
    z-index: 60;
    transform: translateX(-105%);
    transition: transform 200ms ease;
    box-shadow: 0 16px 40px rgba(10, 24, 43, 0.34);
    border-right: 1px solid var(--line);
  }

  .shell.mobile-layout.mobile-nav-open .sidebar {
    transform: translateX(0);
  }

  .shell.mobile-layout.mobile-nav-open .sidebar-overlay {
    opacity: 1;
    pointer-events: auto;
  }

  .shell.mobile-layout .content-area {
    grid-column: 1 / -1;
  }

  .shell.mobile-layout .brand {
    font-size: 1.1rem;
    padding: 8px 12px 14px;
  }

  .shell.mobile-layout .brand::after {
    content: none;
  }

  .shell.mobile-layout .nav-link {
    justify-content: flex-start;
    padding: 8px 10px;
  }

  .shell.mobile-layout .nav-link-label {
    display: inline;
  }

  .topbar {
    padding: max(8px, env(safe-area-inset-top)) 12px 10px;
  }

  .topbar-right {
    width: 100%;
    justify-content: flex-end;
  }

  .pwa-status {
    flex-wrap: wrap;
  }
}

@media (max-width: 900px) {
  .panel {
    padding: 12px;
  }

  .topbar {
    flex-direction: row;
    align-items: center;
  }

  .topbar-right {
    width: auto;
    min-width: 0;
    flex-wrap: nowrap;
    justify-content: flex-end;
  }

  [data-testid="goods-receipt-page"] .warehouse-grid,
  [data-testid="goods-issue-page"] .warehouse-grid,
  [data-testid="stock-transfer-page"] .warehouse-grid {
    grid-template-columns: 1fr;
  }

  .products-table,
  .inventory-table {
    min-width: 600px;
  }

  .warehouse-grid,
  .two-col-grid {
    grid-template-columns: 1fr;
  }

  .batch-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .batch-grid .btn {
    grid-column: 1 / -1;
  }
}

@media (max-width: 768px) {
  .content {
    padding: 10px;
  }

  .topbar {
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    gap: 6px;
    min-height: 58px;
    padding: max(8px, env(safe-area-inset-top)) 10px 8px;
  }

  .topbar-left {
    width: auto;
    flex: 1;
    min-width: 0;
    justify-content: flex-start;
    gap: 6px;
  }

  .topbar-right {
    width: auto;
    min-width: 0;
    justify-content: flex-end;
    gap: 4px;
    flex-wrap: nowrap;
  }

  .topbar-user-name {
    max-width: 84px;
  }

  .topbar .sidebar-toggle,
  .topbar .btn,
  .topbar .pwa-chip,
  .topbar .offline-sync-chip {
    min-height: 44px;
  }

  .products-toolbar,
  .inline-form,
  .scan-form,
  .scan-controls {
    grid-template-columns: 1fr;
  }

  [data-testid="reports-page"] .products-toolbar {
    grid-template-columns: 1fr;
  }

  .panel-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .split-grid,
  .batch-grid {
    grid-template-columns: 1fr;
  }

  .form-grid .input,
  .form-grid select.input,
  .form-grid .btn,
  .form-grid textarea,
  .form-grid .textarea {
    width: 100%;
  }

  .products-table,
  .inventory-table {
    min-width: 540px;
  }

  [data-testid="pick-task-table"] {
    min-width: 100%;
    table-layout: fixed;
  }

  .mobile-cards-table {
    min-width: 0;
    border-spacing: 0 8px;
  }

  .mobile-cards-table thead {
    border: 0;
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
  }

  .mobile-cards-table tbody {
    display: grid;
    gap: 8px;
  }

  .mobile-cards-table tbody tr {
    display: grid;
    gap: 6px;
    border: 1px solid var(--line);
    border-radius: var(--radius-sm);
    padding: 10px;
    background: var(--panel);
  }

  .mobile-cards-table tbody td {
    border-bottom: 0;
    padding: 0;
    min-height: 0;
    display: grid;
    grid-template-columns: minmax(96px, 36%) 1fr;
    gap: 8px;
    align-items: start;
    text-align: left;
  }

  .mobile-cards-table tbody td::before {
    content: attr(data-label);
    color: var(--muted);
    font-size: 0.74rem;
    font-weight: 700;
    letter-spacing: 0.01em;
  }

  .mobile-cards-table tbody td.actions-cell {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: stretch;
  }

  .mobile-cards-table tbody td.actions-cell::before {
    content: attr(data-label);
    flex: 1 0 100%;
    color: var(--muted);
    font-size: 0.74rem;
    font-weight: 700;
    letter-spacing: 0.01em;
  }

  .mobile-cards-table tbody td.actions-cell .btn {
    width: auto;
    flex: 1 1 120px;
  }

  .mobile-cards-table tbody td[data-label="Request ID"] {
    word-break: break-all;
  }

  .mobile-cards-table tbody td[colspan] {
    display: block;
  }

  .mobile-cards-table tbody td[colspan]::before {
    content: none;
  }

  .table-wrap:has(.mobile-cards-table) {
    overflow: visible;
    border: 0;
    background: transparent;
  }

  .table-wrap:has(.mobile-cards-table)::after {
    display: none;
  }

  .table-wrap:has(.products-table, .inventory-table):not(:has(.mobile-cards-table)) {
    position: relative;
  }

  .table-wrap:has(.products-table, .inventory-table):not(:has(.mobile-cards-table))::after {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    width: 20px;
    pointer-events: none;
    background: linear-gradient(90deg, color-mix(in srgb, var(--panel) 0%, transparent), color-mix(in srgb, var(--panel) 95%, transparent));
  }

  .pagination {
    flex-direction: column;
    align-items: flex-start;
  }

  .scan-form .btn {
    width: 100%;
  }

  .offline-sync-panel {
    position: fixed;
    right: 12px;
    left: 12px;
    top: auto;
    bottom: 12px;
    width: auto;
    max-height: min(72vh, 580px);
    overflow: auto;
  }
}
